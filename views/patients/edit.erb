<div class="card card-modern fade-in-card">
  <div class="card-header-modern text-white">
    <h5 class="card-title">
      <i class="bi bi-pencil me-2"></i>Редактирование пациентки
    </h5>
  </div>
  <div class="card-body-modern">
    <form action="/patients/<%= @patient.id %>" method="post" id="patient-form" class="form-modern">
      <input type="hidden" name="_method" value="put">
      
      <!-- Основная информация -->
      <div class="form-section-modern">
        <h6 class="form-section-title-modern">
          <i class="bi bi-person-vcard"></i> Основная информация
        </h6>
        <div class="form-grid-modern">
          <div>
            <label for="full_name" class="form-label-modern">ФИО <span class="text-danger">*</span></label>
            <input type="text" 
                   class="form-control input-modern" 
                   id="full_name" 
                   name="patient[full_name]" 
                   value="<%= @patient.full_name %>"
                   required>
          </div>
          
          <div>
            <label for="age" class="form-label-modern">Возраст</label>
            <input type="number" 
                   class="form-control input-modern" 
                   id="age" 
                   name="patient[age]" 
                   value="<%= @patient.age %>"
                   min="14"
                   max="60">
          </div>
        
        <div>
          <label for="gestational_age" class="form-label-modern">Срок бер.(нед.)</label>
          <input type="number" 
                 class="form-control input-modern" 
                 id="gestational_age" 
                 name="patient[gestational_age]" 
                 value="<%= @patient.gestational_age %>"
                 min="20"
                 max="45">
        </div>
        
        <div>
          <label for="admission_date" class="form-label-modern">Дата поступления <span class="text-danger">*</span></label>
          <input type="date" 
                 class="form-control input-modern" 
                 id="admission_date" 
                 name="patient[admission_date]" 
                 value="<%= @patient.admission_date %>"
                 required>
        </div>
        
        <div>
          <label for="history_number" class="form-label-modern">№ истории болезни</label>
          <input type="text" 
                 class="form-control input-modern" 
                 id="history_number" 
                 name="patient[history_number]" 
                 value="<%= @patient.history_number %>">
        </div>
        
        <div>
          <label for="parity" class="form-label-modern">Партитет</label>
          <input type="number" 
                 class="form-control input-modern"  
                 id="parity" 
                 name="patient[parity]" 
                 value="<%= @patient.parity %>"
                 min="0">
        </div>
        
        <div>
          <label for="labor_start" class="form-label-modern">Начало родов</label>
          <input type="datetime-local" 
                 class="form-control input-modern" 
                 id="labor_start" 
                 name="patient[labor_start]"
                 value="<%= @patient.labor_start&.strftime('%Y-%m-%dT%H:%M') %>">
        </div>
        
        <div>
          <label for="active_phase_start" class="form-label-modern">Начало активной фазы</label>
          <input type="datetime-local" 
                 class="form-control input-modern" 
                 id="active_phase_start" 
                 name="patient[active_phase_start]"
                 value="<%= @patient.active_phase_start&.strftime('%Y-%m-%dT%H:%M') %>">
        </div>
        
        <div>
          <label for="membrane_rupture" class="form-label-modern">Разрыв плодных оболочек</label>
          <input type="datetime-local" 
                 class="form-control input-modern" 
                 id="membrane_rupture" 
                 name="patient[membrane_rupture]"
                 value="<%= @patient.membrane_rupture&.strftime('%Y-%m-%dT%H:%M') %>">
        </div>
        
        <div>
          <label for="status" class="form-label-modern">Статус <span class="text-danger">*</span></label>
          <select class="form-control input-modern"  id="status" name="patient[status]" required>
            <% Patient::STATUSES.each_value do |status| %>
              <option value="<%= status %>" <%= 'selected' if @patient.status == status %>>
                <%= status %>
              </option>
            <% end %>
          </select>
        </div>
        
        <div>
          <label for="risk_factors" class="form-label">Значимые факторы риска</label>
          <textarea class="form-control touch-friendly" 
                    id="risk_factors" 
                    name="patient[risk_factors]" 
                    rows="3"><%= @patient.risk_factors %></textarea>
        </div>
        
        <div>
          <label for="notes" class="form-label">Примечания</label>
          <textarea class="form-control touch-friendly" 
                    id="notes" 
                    name="patient[notes]" 
                    rows="3"><%= @patient.notes %></textarea>
        </div>
      </div>
      
     <div class="form-actions-modern">
        <a href="/patients" class="btn btn-outline-secondary">
          <i class="bi bi-arrow-left me-1"></i>
          <span>Назад к списку</span>
        </a>
        
        <div class="action-buttons-modern">
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-check-circle me-1"></i>
            <span>Сохранить изменения</span>
          </button>
          
          <a href="/patients/<%= @patient.id %>/partogram" 
             class="btn btn-outline-primary">
            <i class="bi bi-graph-up me-1"></i>
            <span>Перейти к партограмме</span>
          </a>
        </div>
      </div>
    </form>
  </div>
</div>